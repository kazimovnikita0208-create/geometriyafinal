# ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!

## üéâ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ö–µ–º–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `address` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `rejection_reason` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã: `pending`, `confirmed`, `rejected`, `expired`, `completed`
- ‚úÖ –ë–∞–∑–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∞ —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π

### 2. **Backend API** ‚úÖ
- ‚úÖ `POST /api/subscriptions` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- ‚úÖ `GET /api/subscriptions/my` ‚Äî –≤—Å–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `GET /api/subscriptions/active` ‚Äî —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
- ‚úÖ `GET /api/subscriptions/requests` ‚Äî –¥–ª—è –∞–¥–º–∏–Ω–∞ (–≤—Å–µ –∑–∞—è–≤–∫–∏)
- ‚úÖ `POST /api/subscriptions/:id/approve` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–∞–¥–º–∏–Ω)
- ‚úÖ `POST /api/subscriptions/:id/reject` ‚Äî –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π (–∞–¥–º–∏–Ω)
- ‚úÖ **–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (DEV_MODE)** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤

### 3. **Frontend** ‚úÖ
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/prices` ‚Äî –≤—ã–±–æ—Ä –∏ –ø–æ–∫—É–ø–∫–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ñ–æ—Ä–º–æ–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/profile` ‚Äî –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `SubscriptionCard` ‚Äî –∫—Ä–∞—Å–∏–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ú–æ–¥—É–ª—å `lib/auth.ts` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram

### 4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ
- ‚úÖ Backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001
- ‚úÖ Frontend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3002
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ DEV_MODE –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```
   http://localhost:3002/prices
   ```

2. **–í—ã–±–µ—Ä–∏—Ç–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç:**
   - –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∑–∞–Ω–∏–º–∞—Ç—å—Å—è"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
     - –ò–º—è: **–ù–∏–∫–∏—Ç–∞**
     - –§–∞–º–∏–ª–∏—è: **–ò–≤–∞–Ω–æ–≤**
     - –¢–µ–ª–µ—Ñ–æ–Ω: **89397187500**
     - –ê–¥—Ä–µ—Å –∑–∞–ª–∞: **–¢–û–¶ "–û—Ö–æ—Ç–Ω—ã–π —Ä—è–¥"**
   - –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç:**
   ```
   http://localhost:3002/profile
   ```
   
   –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   - üü° –ö–∞—Ä—Ç–æ—á–∫—É –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º **"–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"**
   - –ñ–µ–ª—Ç—ã–π —Ü–≤–µ—Ç –∏ –∑–Ω–∞—á–æ–∫ —á–∞—Å–æ–≤
   - –°–æ–æ–±—â–µ–Ω–∏–µ: "–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏..."

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

```bash
cd backend
node test-subscription.js
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ –ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
   ID: 1
   –°—Ç–∞—Ç—É—Å: pending
   –ê–±–æ–Ω–µ–º–µ–Ω—Ç: 1 –∑–∞–Ω—è—Ç–∏–µ

‚úÖ –ù–∞–π–¥–µ–Ω–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤: 1
   1. 1 –∑–∞–Ω—è—Ç–∏–µ
      –°—Ç–∞—Ç—É—Å: pending
      –ê–¥—Ä–µ—Å: TOC Okhotny Ryad
      –ó–∞–Ω—è—Ç–∏–π –æ—Å—Ç–∞–ª–æ—Å—å: 1
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î:

```bash
cd backend
node check-db.js
```

## üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (DEV_MODE)

### –ß—Ç–æ —ç—Ç–æ?
–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É JWT —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ö–∞–∫ –≤–∫–ª—é—á–µ–Ω?
–í —Ñ–∞–π–ª–µ `backend/.env`:
```env
DEV_MODE=true
```

### –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- `telegram_id`: 999999999
- `first_name`: –¢–µ—Å—Ç–æ–≤—ã–π
- `last_name`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `phone`: 89397187500

### ‚ö†Ô∏è –í–ê–ñ–ù–û!
**–ù–ï –ò–°–ü–û–õ–¨–ó–£–ô–¢–ï DEV_MODE=true –í –ü–†–û–î–ê–ö–®–ï–ù–ï!**

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DEV_MODE=false` –≤ `.env`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

## üìã –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`/admin`) —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏:

### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞:
1. **–ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫**
   - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, –∞–¥—Ä–µ—Å)
   - –î–µ—Ç–∞–ª–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, —Å—Ä–æ–∫)

2. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏**
   - –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"
   - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `confirmed`
   - `is_active` = 1
   - –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

3. **–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏**
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å"
   - –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –ø—Ä–∏—á–∏–Ω—ã
   - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `rejected`
   - –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π

### API —É–∂–µ –≥–æ—Ç–æ–≤:
- `GET /api/subscriptions/requests?status=pending`
- `POST /api/subscriptions/:id/approve`
- `POST /api/subscriptions/:id/reject`

–ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç—å UI –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏!

## üéØ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:

- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Backend API
- ‚úÖ Frontend (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫)
- ‚úÖ Frontend (–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç)
- ‚è≥ Frontend (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å) - **–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì**
- ‚è≥ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üìù –§–∞–π–ª—ã –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è:

- `backend/DEV_MODE.md` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `backend/docs/SUBSCRIPTIONS_FLOW.md` ‚Äî –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞
- `backend/docs/SUBSCRIPTIONS_API.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- `TESTING_SUBSCRIPTIONS.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

